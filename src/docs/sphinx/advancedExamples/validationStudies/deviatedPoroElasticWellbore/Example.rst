.. _AdvancedExampleDeviatedPoroElasticWellbore:


####################################################
Deviated Poro-Elastic Wellbore Problem
####################################################

------------------------------------------------------------------
Problem description
------------------------------------------------------------------

This example aims to solve a typical injection problem of a deviated poroelastic open wellbore subjected to a fluid pressure injected inside the hole. The problem geometry is generated by the interal wellbore mesh generator. The poroelastic coupled solver, that is a combination of the solid mechanic solver and the single phase flow solver, is employed to solver this coupling problem. In-situ stress and pressure are excluded from this example.

Analytical results of the fluid pressure, and the radial and hoop stresses around the wellbore are expressed in the Laplace space as `(Detournay and Cheng, 1988) <https://www.sciencedirect.com/science/article/abs/pii/0148906288922991>`__ :

.. math::
    p = p_0 \frac{kn(0,R \sqrt{s})}{s kn(0,\sqrt{s})}

.. math::
    \sigma_{rr} = -b \frac{1-2\nu}{1-\nu} p_0 \frac{-R * kn(1,R \sqrt{s}) + kn(1,\sqrt{s})}{R^2 \sqrt{s^3} kn(0,\sqrt{s})}

.. math::
    \sigma_{\theta\theta} = -b \frac{1-2\nu}{1-\nu} p - \sigma_{rr}

where :math:`s` is the Laplace variable, :math:`R` is the dimensionless radial coordinate that is defined by the radial coordinate normalized by the hole radius, :math:`\nu` the Poisson ratio and :math:`b` the Biot coefficient. Fluid pressure and stresses in time space are obtained from these analytical expression by the inverse Laplace transformation (see the attached Python script for more details).  


**Input file**

Everything required is
contained within a single GEOSX input file that is located at:

.. code-block:: console

  src/coreComponents/physicsSolvers/multiphysics/benchmarks/DeviatedPoroElasticWellbore_Injection.xml


In this example, we would focus our attention on the ``Solver`` and the ``Mesh`` tags.

-----------------------------------------------------------
Poroelastic solver
-----------------------------------------------------------

The coupled ``Poroelastic`` solver, that is a coupling between the solid mechanic solver ``SolidMechanicsLagrangianSSLE`` and the single phase flow solver ``SinglePhaseFVM``, is required for solving this wellbore problem.  

.. literalinclude:: ../../../../../../src/coreComponents/physicsSolvers/multiphysics/benchmarks/DeviatedPoroElasticWellbore_Injection.xml
  :language: xml
  :start-after: <!-- SPHINX_PoroelasticSolver -->
  :end-before: <!-- SPHINX_PoroelasticSolverEnd -->


.. literalinclude:: ../../../../../../src/coreComponents/physicsSolvers/multiphysics/benchmarks/DeviatedPoroElasticWellbore_Injection.xml
  :language: xml
  :start-after: <!-- SPHINX_SolidMechanicsSolver -->
  :end-before: <!-- SPHINX_SolidMechanicsSolverEnd -->


.. literalinclude:: ../../../../../../src/coreComponents/physicsSolvers/multiphysics/benchmarks/DeviatedPoroElasticWellbore_Injection.xml
  :language: xml
  :start-after: <!-- SPHINX_SinglePhaseFVM -->
  :end-before: <!-- SPHINX_SinglePhaseFVMEnd -->


--------------------------------------------------------------------
Deviated wellbore mesh
--------------------------------------------------------------------

The internal wellbore mesh generator ``InternalWellbore`` is employed to create the mesh of this wellbore problem. The radius of the wellbore and the size of the surrounding rock formation are defined by a vector ``radius``. In the tangent direction, ``theta`` angle is specified from 0 to 180 degree for a half of the domain regarding its symmetry. Note that the whole domain could be specified with a ``theta`` angle from 0 to 360 degree, if modeling complicated scenarios. The trajectory of the well is defined by ``trajectory``. In this example, the wellbore is inclined in the x-z plane by an angle of 45 degree. The ``autoSpaceRadialElems`` parameter allows optimally increasing the element size from local zone around the wellbore to the far-field zone, which is set to 1 to activate this option. The ``useCartesianOuterBoundary`` transforms the far-field boundary to a squared shape to enforce a Cartesian aligned outer boundary, which eases the loading of the far-field boundary conditions. In this example, this value is set to 0 for the single region along the radial direction.  
 
.. literalinclude:: ../../../../../../src/coreComponents/physicsSolvers/multiphysics/benchmarks/DeviatedPoroElasticWellbore_Injection.xml
  :language: xml
  :start-after: <!-- SPHINX_WellboreMesh -->
  :end-before: <!-- SPHINX_WellboreMeshEnd -->

.. figure:: mesh.png
   :align: center
   :figclass: align-center


--------------------------------------------------------------------   
Constitutive law
--------------------------------------------------------------------

Isotropic ``PoroElasticIsotropic`` constitutive behavior, with the specified bulk and shear elastic moduli and the Biot coefficient, is considered for the rock around the wellbore. Fluid constitutive properties such as dynamic viscosity, compressibility, etc. are given in the ``CompressibleSinglePhaseFluid`` constitutive block. 

.. literalinclude:: ../../../../../../src/coreComponents/physicsSolvers/multiphysics/benchmarks/DeviatedPoroElasticWellbore_Injection.xml
  :language: xml
  :start-after: <!-- SPHINX_Material -->
  :end-before: <!-- SPHINX_MaterialEnd -->


--------------------------------------------------------------------	       
Boundary conditions
--------------------------------------------------------------------

Far-field boundaries are subjected to roller constraints and impermeable condition. The pressure on the wellbore wall is defined by face pressure field specification. The nodeset generated by the internal wellbore generator for this face is named as ``rneg``. The negative sign of the scale is attributed to the negative sign convention for compressive stresses in GEOSX. Initial fluid pressure, reference porosity and permeability are also given for the whole domain. In this example, uniform isotropic permeability is assumed.

.. literalinclude:: ../../../../../../src/coreComponents/physicsSolvers/multiphysics/benchmarks/DeviatedPoroElasticWellbore_Injection.xml
  :language: xml
  :start-after: <!-- SPHINX_BoundaryConditions -->
  :end-before: <!-- SPHINX_BoundaryConditionsEnd -->

---------------------------------
Results and benchmark
---------------------------------

A good agreement between the GEOSX results and the corresponding analytical solutions is shown in the figure below:


.. plot::




------------------------------------------------------------------
To go further
------------------------------------------------------------------

**Feedback on this example**

This concludes the deviated poro-elastic wellbore example.
For any feedback on this example, please submit a `GitHub issue on the project's GitHub page <https://github.com/GEOSX/GEOSX/issues>`_.
