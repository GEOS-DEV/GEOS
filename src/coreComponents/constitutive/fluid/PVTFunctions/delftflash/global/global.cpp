#include <iostream>
#include <vector>
#include <complex>
#include <unordered_map>

#include "global.h"

namespace CompProp {
    std::unordered_map<std::string, char> species_type = {
        {"H2O", 'm'}, {"CO2", 'm'}, {"N2", 'm'}, {"H2S", 'm'}, {"C1", 'm'}, {"C2", 'm'}, {"C3", 'm'}, {"iC4", 'm'}, {"nC4", 'm'}, {"iC5", 'm'}, {"nC5", 'm'}, {"nC6", 'm'}, {"nC7", 'm'}, {"nC8", 'm'}, {"nC9", 'm'}, {"nC10", 'm'},
        {"Na+", 'i'}, {"K+", 'i'}, {"Ca2+", 'i'}, {"Mg2+", 'i'}, {"Cl-", 'i'},
    };
    std::unordered_map<std::string, int> charge = {{"Na+", 1}, {"K+", 1}, {"Ca2+", 2}, {"Mg2+", 2}, {"Cl-", -1}};
    
    std::unordered_map<std::string, std::unordered_map<std::string, double>> prop = {
        {"Tc", {{"H2O", 647.14}, {"CO2", 304.10}, {"N2", 126.20}, {"H2S", 373.53}, {"C1", 190.58}, {"C2", 305.32}, {"C3", 369.83}, {"iC4", 407.85}, {"nC4", 425.12}, {"iC5", 460.45}, {"nC5", 469.70}, {"nC6", 507.60}, {"nC7", 540.20}, {"nC8", 569.32}, {"nC9", 594.6}, {"nC10", 617.7}, }},
        {"Pc", {{"H2O", 220.50}, {"CO2", 73.75}, {"N2", 34.00}, {"H2S", 89.63}, {"C1", 46.04}, {"C2", 48.721}, {"C3", 42.481}, {"iC4", 36.40}, {"nC4", 37.960}, {"iC5", 33.77}, {"nC5", 33.701}, {"nC6", 30.251}, {"nC7", 27.40}, {"nC8", 24.97}, {"nC9", 22.88}, {"nC10", 21.2}, }},
        {"ac", {{"H2O", 0.328}, {"CO2", 0.239}, {"N2", 0.0377}, {"H2S", 0.0942}, {"C1", 0.012}, {"C2", 0.0995}, {"C3", 0.1523}, {"iC4", 0.1844}, {"nC4", 0.2002}, {"iC5", 0.227}, {"nC5", 0.2515}, {"nC6", 0.3013}, {"nC7", 0.3495}, {"nC8", 0.396}, {"nC9", 0.445}, {"nC10", 0.489}, }},
        {"Mw", {{"H2O", 18.015}, {"CO2", 44.01}, {"N2", 28.013}, {"H2S", 34.10}, {"C1", 16.043}, {"C2", 30.07}, {"C3", 44.097}, {"iC4", 58.124}, {"nC4", 58.124}, {"iC5", 72.151}, {"nC5", 72.151}, {"nC6", 86.178}, {"nC7", 100.205}, {"nC8", 114.231}, {"nC9", 128.257}, {"nC10", 142.2848}, }}
    };
	std::unordered_map<std::string, std::unordered_map<std::string, double>> bic = {
		{"H2O", {{"H2O", 0.}, {"CO2", 0.19014}, {"N2", 0.32547}, {"H2S", 0.105}, {"C1", 0.47893}, {"C2", 0.5975}, {"C3", 0.5612}, {"iC4", 0.508}, {"nC4", 0.5569}, {"iC5", 0.5}, {"nC5", 0.5260}, {"nC6", 0.4969}, {"nC7", 0.4880}, {"nC8", 0.48}, {"nC9", 0.48}, {"nC10", 0.48}, }},
        {"CO2", {{"H2O", 0.19014}, {"CO2", 0.}, {"N2", -0.0462}, {"H2S", 0.1093}, {"C1", 0.0936}, {"C2", 0.1320}, {"C3", 0.1300}, {"iC4", 0.13}, {"nC4", 0.1336}, {"iC5", 0.13}, {"nC5", 0.1454}, {"nC6", 0.1167}, {"nC7", 0.1209}, {"nC8", 0.1}, {"nC9", 0.1}, {"nC10", 0.1}, }},
        {"N2",  {{"H2O", 0.32547}, {"CO2", -0.0462}, {"N2", 0.}, {"H2S", 0.1475}, {"C1", 0.0291}, {"C2", 0.0082}, {"C3", 0.0862}, {"iC4", 0.1}, {"nC4", 0.0596}, {"iC5", 0.1}, {"nC5", 0.0917}, {"nC6", 0.1552}, {"nC7", 0.1206}, {"nC8", 0.1}, {"nC9", 0.1}, {"nC10", 0.1}, }},
        {"H2S", {{"H2O", 0.105}, {"CO2", 0.1093}, {"N2", 0.1475}, {"H2S", 0.}, {"C1", 0.0912}, {"C2", 0.0846}, {"C3", 0.0874}, {"iC4", 0.06}, {"nC4", 0.0564}, {"iC5", 0.06}, {"nC5", 0.0655}, {"nC6", 0.0465}, {"nC7", 0.0191}, {"nC8", 0}, {"nC9", 0}, {"nC10", 0.1}, }},
        {"C1",  {{"H2O", 0.47893}, {"CO2", 0.0936}, {"N2", 0.0291}, {"H2S", 0.0912}, {"C1", 0.}, {"C2", 0.00518}, {"C3", 0.01008}, {"iC4", 0.026717}, {"nC4", 0.0152}, {"iC5", 0.0206}, {"nC5", 0.0193}, {"nC6", 0.0258}, {"nC7", 0.0148}, {"nC8", 0.037}, {"nC9", 0.03966}, {"nC10", 0.048388}, }},
        {"C2",  {{"H2O", 0.5975}, {"CO2", 0.1320}, {"N2", 0.0082}, {"H2S", 0.0846}, {"C1", 0.00518}, {"C2", 0.}, {"C3", 0.}, {"iC4", 0.}, {"nC4", 0.}, {"nC5", 0.}, {"iC5", 0.}, {"nC6", 0.}, {"nC7", 0.}, {"nC8", 0.}, {"nC9", 0.}, {"nC10", 0.}, }},
        {"C3",  {{"H2O", 0.5612}, {"CO2", 0.1300}, {"N2", 0.0862}, {"H2S", 0.0874}, {"C1", 0.01008}, {"C2", 0.}, {"C3", 0.}, {"iC4", 0.}, {"nC4", 0.}, {"nC5", 0.}, {"iC5", 0.}, {"nC6", 0.}, {"nC7", 0.}, {"nC8", 0.}, {"nC9", 0.}, {"nC10", 0.}, }},
        {"iC4", {{"H2O", 0.508}, {"CO2", 0.13}, {"N2", 0.1}, {"H2S", 0.06}, {"C1", 0.026717},{"C2", 0.}, {"C3", 0.}, {"iC4", 0.}, {"nC4", 0.}, {"nC5", 0.}, {"iC5", 0.}, {"nC6", 0.}, {"nC7", 0.}, {"nC8", 0.}, {"nC9", 0.}, {"nC10", 0.}, }},
        {"nC4", {{"H2O", 0.5569}, {"CO2", 0.1336}, {"N2", 0.0596}, {"H2S", 0.0564}, {"C1", 0.0152}, {"C2", 0.}, {"C3", 0.}, {"iC4", 0.}, {"nC4", 0.}, {"nC5", 0.}, {"iC5", 0.}, {"nC6", 0.}, {"nC7", 0.}, {"nC8", 0.}, {"nC9", 0.}, {"nC10", 0.}, }},
        {"iC5", {{"H2O", 0.5}, {"CO2", 0.13}, {"N2", 0.1}, {"H2S", 0.06}, {"C1", 0.0206}, {"C2", 0.}, {"C3", 0.}, {"iC4", 0.}, {"nC4", 0.}, {"nC5", 0.}, {"iC5", 0.}, {"nC6", 0.}, {"nC7", 0.}, {"nC8", 0.}, {"nC9", 0.}, {"nC10", 0.}, }},
        {"nC5", {{"H2O", 0.5260}, {"CO2", 0.1454}, {"N2", 0.0917}, {"H2S", 0.0655}, {"C1", 0.0193}, {"C2", 0.}, {"C3", 0.}, {"iC4", 0.}, {"nC4", 0.}, {"nC5", 0.}, {"iC5", 0.}, {"nC6", 0.}, {"nC7", 0.}, {"nC8", 0.}, {"nC9", 0.}, {"nC10", 0.}, }},
        {"nC6", {{"H2O", 0.4969}, {"CO2", 0.1167}, {"N2", 0.1552}, {"H2S", 0.0465}, {"C1", 0.0258}, {"C2", 0.}, {"C3", 0.}, {"iC4", 0.}, {"nC4", 0.}, {"nC5", 0.}, {"iC5", 0.}, {"nC6", 0.}, {"nC7", 0.}, {"nC8", 0.}, {"nC9", 0.}, {"nC10", 0.}, }},
        {"nC7", {{"H2O", 0.4880}, {"CO2", 0.1209}, {"N2", 0.1206}, {"H2S", 0.0191}, {"C1", 0.0148}, {"C2", 0.}, {"C3", 0.}, {"iC4", 0.}, {"nC4", 0.}, {"nC5", 0.}, {"iC5", 0.}, {"nC6", 0.}, {"nC7", 0.}, {"nC8", 0.}, {"nC9", 0.}, {"nC10", 0.}, }},
        {"nC8", {{"H2O", 0.48}, {"CO2", 0.1}, {"N2", 0.1}, {"H2S", 0}, {"C1", 0.037}, {"C2", 0.}, {"C3", 0.}, {"iC4", 0.}, {"nC4", 0.}, {"nC5", 0.}, {"iC5", 0.}, {"nC6", 0.}, {"nC7", 0.}, {"nC8", 0.}, {"nC9", 0.}, {"nC10", 0.}, }},
        {"nC9", {{"H2O", 0.48}, {"CO2", 0.1}, {"N2", 0.1}, {"H2S", 0}, {"C1", 0.03966}, {"C2", 0.}, {"C3", 0.}, {"iC4", 0.}, {"nC4", 0.}, {"nC5", 0.}, {"iC5", 0.}, {"nC6", 0.}, {"nC7", 0.}, {"nC8", 0.}, {"nC9", 0.}, {"nC10", 0.}, }},
        {"nC10", {{"H2O", 0.48}, {"CO2", 0.1}, {"N2", 0.1}, {"H2S", 0.1}, {"C1", 0.048388}, {"C2", 0.}, {"C3", 0.}, {"iC4", 0.}, {"nC4", 0.}, {"nC5", 0.}, {"iC5", 0.}, {"nC6", 0.}, {"nC7", 0.}, {"nC8", 0.}, {"nC9", 0.}, {"nC10", 0.}, }}
	};
	
	// Henry's constant	
	// https://acp.copernicus.org/articles/15/4399/2015/acp-15-4399-2015.pdf
	double T_0 = 298.15;
	std::unordered_map<std::string, double> H0 = {{"CO2", 33.}, {"N2", 0.64}, {"H2S", 100.}, {"C1", 1.4}, {"C2", 1.9}, {"C3", 1.5}, {"iC4", 0.91}, {"nC4", 1.2}, {"iC5", 0.7}, {"nC5", 0.8}, {"nC6", 0.61}, {"nC7", 0.44}, {"nC8", 0.31}, {"nC9", 0.2}, {"nC10", 0.14}, };
	std::unordered_map<std::string, double> dlnH = {{"CO2", 2400.}, {"N2", 1600.}, {"H2S", 2100.}, {"C1", 1900.}, {"C2", 2400.}, {"C3", 2700.}, {"iC4", 2700.}, {"nC4", 3100.}, {"iC5", 3400.}, {"nC5", 3400.}, {"nC6", 3800.}, {"nC7", 4100.}, {"nC8", 4300.}, {"nC9", 5000.}, {"nC10", 5000.}, };
}

namespace aq1_par { // parameters for Ziabaksh correlation for Aq phase
	std::unordered_map<std::string, std::vector<double>> labda = {
		{"CO2", {-0.0652869, 1.6790636E-4, 40.838951, 0, 0, -3.9266518E-2, 0, 2.1157167E-2, 6.5486487E-6, 0, 0, 0}},
		{"N2", {-2.0939363, 3.1445269E-3, 3.913916E2, -2.9973977E-7, 0, -1.5918098E-5, 0, 0, 0, 0, 0, 0}},
		{"H2S", {1.03658689, -1.1784797E-3, -1.7754826E2, -4.5313285E-4, 0, 0, 0, 0, 0, 0.4775165E2, 0, 0}},
		{"C1", {-5.7066455E-1, 7.2997588E-4, 1.5176903E2, 3.1927112E-5, 0, -1.642651E-5, 0, 0, 0, 0, 0, 0}},
		{"C2", {-2.143686, 2.598765E-3, 4.6942351E2, -4.6849541E-5, 0, 0, 0, 0, 0, 0, -8.4616602E-10, 1.095219E-6}},
		{"C3", {0.513068, -0.000958, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}},
		{"iC4", {0.52862384, -1.0298104E-3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}},
		{"nC4", {0.52862384, -1.0298104E-3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}},
		// {"iC5", {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}},
		// {"nC5", {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}},
		// {"nC6", {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}},
		// {"nC7", {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}},
		// {"nC8", {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}},
		// {"nC9", {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}},
		// {"nC10", {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}},
	};
	std::unordered_map<std::string, std::vector<double>> ksi = {
		{"CO2", {-1.144624E-2, 2.8274958E-5, 1.3980876E-2, -1.4349005E-2}},
		{"N2", {-6.3981858E-3, 0, 0, 0}},
		{"H2S", {0.010274152, 0, 0, 0}},
		{"C1", {-2.9990084E-3, 0, 0, 0}},
		{"C2", {-1.0165947E-2, 0, 0, 0}},
		{"C3", {-0.007485, 0, 0, 0}},
		{"iC4", {0.0206946, 0, 0, 0}},
		{"nC4", {0.0206946, 0, 0, 0}},
	};
	std::unordered_map<std::string, double> eta = {{"CO2", -0.114535}, {"N2", -0.008194}, {"H2S", 0.77357854}, {"C1", -0.092248}, {"C2", -0.6091}, {"C3", -1.1471}, {"iC4", -1.6849}, {"nC4", -1.6849}};
	std::unordered_map<std::string, double> tau = {{"CO2", -5.279063}, {"N2", -5.175337}, {"H2S", 0.27049433}, {"C1", -5.779280}, {"C2", -16.8037}, {"C3", -25.3879}, {"iC4", -33.8492}, {"nC4", -33.8492}};
	std::unordered_map<std::string, double> beta = {{"CO2", 6.187967}, {"N2", 6.906469}, {"H2S", 0.27543436}, {"C1", 7.262730}, {"C2", 20.0628}, {"C3", 28.2616}, {"iC4", 36.1457}, {"nC4", 36.1457}};
	std::unordered_map<std::string, double> Gamma = {{"CO2", 0}, {"N2", 0}, {"H2S", 0}, {"C1", 0}, {"C2", 0}, {"C3", 0}, {"iC4", 0}, {"nC4", 0}};
	
	double R{ 83.145 };
}

namespace aq2_par {
    double R = 8.3145; double T_0 = 298.15; double P_0 = 1.0;
    // gibbs energy of pure H2O or 1 molal solution at p0, T0
    std::unordered_map<std::string, double> gi_0 =  {{"H2O", -237129}, {"CO2", -385974}, {"N2", 18188}, {"H2S", -27920}, {"C1", -34451}, {"C2", -17000}, {"C3", -7550}, {"nC4", -940}, {"nC5", 9160}, {"nC6", 18200}, {"nC7", 27500} };
    // molar enthalpy of pure H2O or 1 molal solution at p0, T0
    std::unordered_map<std::string, double> hi_0 =  {{"H2O", -285830}, {"CO2", -413798}, {"N2", -10439}, {"H2S", -37660}, {"C1", -87906}, {"C2", -103136}, {"C3", -131000}, {"nC4", -152000}, {"nC5", -173887}, {"nC6", -199200}, {"nC7", -225000} };
    // gibbs energy of ideal gas at p0, T0
    std::unordered_map<std::string, double> gi_00 = {{"H2O", -228700}, {"CO2", -394600}, {"N2", 0}, {"H2S", -33100}, {"C1", -50830}, {"C2", -32900}, {"C3", -23500}, {"nC4", -17200}, {"nC5", -8370}, {"nC6", -290}, {"nC7", 8120} };
    // molar enthalpy of ideal gas at p0, T0
    std::unordered_map<std::string, double> hi_00 = {{"H2O", -242000}, {"CO2", -393800}, {"N2", 0}, {"H2S", -20200}, {"C1", -74900}, {"C2", -84720}, {"C3", -103900}, {"nC4", -126200}, {"nC5", -146500}, {"nC6", -167300}, {"nC7", -187900} };
    // ideal gas heat capacity parameters [eq. 3.4]
    std::unordered_map<std::string, std::vector<double>> hi_a =  {
        {"H2O", {3.8747*R, 0.0231E-2*R, 0.1269E-5*R, -0.4321E-9*R}},
        {"CO2", {2.6751*R, 0.7188E-2*R, -0.4208E-5*R, 0.8977E-9*R}},
        {"N2", {3.4736*R, -0.0189E-2*R, 0.0971E-5*R, -0.3453E-9*R}},
        {"H2S", {3.5577*R, 0.1574E-2*R, 0.0686E-5*R, -0.3959E-9*R}},
        {"C1", {2.3902*R, 0.6039E-2*R, 0.1525E-5*R, -1.3234E-9*R}},
        {"C2", {0.8293*R, 2.0752E-2*R, -0.7699E-5*R, 0.8756E-9*R}},
        {"C3", {-0.4861*R, 3.6629E-2*R, -1.8895E-5*R, 3.8143E-9*R}},
        {"nC4", {0.4755*R, 4.4650E-2*R, -2.2041E-5*R, 4.2068E-9*R}},
        {"nC5", {0.8142*R, 5.4598E-2*R, -2.6997E-5*R, 5.0824E-9*R}},
        {"nC6", {0.8338*R, 6.6373E-2*R, -3.444E-5*R, 6.9342E-9*R}},
        {"nC7", {-0.6184*R, 8.1268E-2*R, -4.388E-5*R, 9.2037E-9*R}},
    };
    // Born constants of solutes [eq. 3.6-3.7]
    std::unordered_map<std::string, double> omega = {{"CO2", -8368}, {"N2", -145101}, {"H2S", -41840}, {"C1", -133009}, {"C2", -169870}, {"C3", -211418}, {"nC4", -253592}, {"nC5", -300955}, {"nC6", -335180}, {"nC7", -380158} };
    // Partial molar heat capacity terms [eq. 3.6]
    std::unordered_map<std::string, double> cp1 = {{"CO2", 167.50}, {"N2", 149.75}, {"H2S", 135.14}, {"C1", 176.12}, {"C2", 226.67}, {"C3", 277.52}, {"nC4", 330.77}, {"nC5", 373.24}, {"nC6", 424.53}, {"nC7", 472.37}, };
    std::unordered_map<std::string, double> cp2 = {{"CO2", 5304066}, {"N2", 5046230}, {"H2S", 2850801}, {"C1", 6310762}, {"C2", 9011737}, {"C3", 11749531}, {"nC4", 14610096}, {"nC5", 16955051}, {"nC6", 19680558}, {"nC7", 22283347}, };
    // Partial molar volume terms [eq. 3.7]
    std::unordered_map<std::string, std::vector<double>> vp = {
        {"CO2", {2.614, 3125.9, 11.7721, -129198}},
        {"N2", {2.596, 3083.0, 11.9407, -129018}},
        {"H2S", {2.724, 2833.6, 24.9559, -127989}},
        {"C1", {2.829, 3651.8, 9.7119, -131365}},
        {"C2", {3.612, 5565.2, 2.1778, -139277}},
        {"C3", {4.503, 7738.2, -6.3316, -148260}},
        {"nC4", {5.500, 11014.4, -14.9298, -157256}},
        {"nC5", {6.282, 12082.2, -23.4091, -166218}},
        {"nC6", {7.175, 14264.4, -32.0202, -175238}},
        {"nC7", {8.064, 16435.2, -40.5342, -184213}},
    };
    // Dielectric constant of water coefficients [eq. 3.9]
    std::vector<double> eps = {243.9576, 0.039037, -1.01261E-5, 
                            -0.7520846, -2.12309E-4, 6.04961E-8, 
                            6.60648E-4, 3.18021E-7, -9.33341E-11};

    // Solute interaction parameters eq. 3.18-3.20
    std::unordered_map<std::string, std::unordered_map<std::string, std::vector<double>>> Bca = {
        {"Na+", {{"Cl-", {-0.554860699, 4.2795E-3, -6.529E-6}}}},
        {"K+", {{"Cl-", {0.178544751, -9.55043E-4, 1.8208E-6}}}},
        {"Ca2+", {{"Cl-", {0.549244833, -1.870735E-3, 3.3604E-6}}}},
    };
    std::unordered_map<std::string, std::unordered_map<std::string, std::vector<double>>> Cca = {
        {"Na+", {{"Cl-", {-0.016131327, -1.25089E-5, 5.89E-8}}}},
        {"K+", {{"Cl-", {-5.546927E-3, 4.22294E-5, -9.038E-8}}}},
        {"Ca2+", {{"Cl-", {-0.011031685, 7.49491E-5, -1.639E-7}}}},
    };
    std::unordered_map<std::string, std::unordered_map<std::string, std::vector<double>>> Dca = {
        {"Na+", {{"Cl-", {-1.12161E-3, 2.49474E-5, -4.603E-8}}}},
        {"K+", {{"Cl-", {7.12650E-5, -6.04659E-7, 1.327E-9}}}},
        {"Ca2+", {{"Cl-", {1.08383E-4, -1.03524E-6, 2.3878E-9}}}},
    };
    std::unordered_map<std::string, std::unordered_map<std::string, std::vector<double>>> B = {
        {"H2S", {{"H2S", {0.1, -4.7e-4, 0., 0.}}}},
        {"CO2", {{"CO2", {0.107, -4.5e-4, 0., 0.}}}},
        {"C1", {{"Na+", {0.025, 0., 0. -5e-3}}, {"Cl-", {0.025, 0., 0. -5e-3}}}},
        {"C3", {{"Na+", {-0.09809, 4.19e-4, -6.2e-6, 0.}}, {"Cl-", {-0.09809, 4.19e-4, -6.2e-6, 0.}}}},
    };

    double e = 1.60218E-19; double eps0 = 8.85419E-12;
}
