<?xml version="1.0" encoding="UTF-8"?>
<Problem>
	<Solvers>
		<SolidMechanics_FEM_AES 
		name="mechSolve" 
		targetRegions="{Region1,Fracture}"
		initialDt="10"
		solidSolverName="matrixSolver"
		contactRelationName="fractureContact"
		logLevel="2"
		>
		<NonlinearSolverParameters 
        name="nlsp"
        newtonTol="1.0e-6"
        newtonMaxIter="1"
        maxTimeStepCuts="1"/>
        <SystemSolverParameters 
        name="ssp"
        krylovTol="1.0e-10"
        logLevel="2"/>
		</SolidMechanics_FEM_AES>
		<SolidMechanicsLagrangianSSLE 
		name="matrixSolver" 
        timeIntegrationOption="QuasiStatic"
        logLevel="1"
        discretization="FE1"
        targetRegions="{Region1}"
        solidMaterialName="rock"/>
		<EmbeddedSurfaceGenerator
        name="SurfaceGenerator"
        solidMaterialName="rock"
        targetRegions="{Region1, Fracture}"
        fractureRegion="Fracture"
        logLevel="2"/>
	</Solvers>

	<Mesh>
		<InternalMesh 
		name="mesh1" 
		elementTypes="{C3D8}" 
		xCoords="{0, 10}"
		yCoords="{0, 10}" 
		zCoords="{0, 10}" 
		nx="{2}" ny="{2}" nz="{1}"
		cellBlockNames="{cb1}" />
	</Mesh>

	<Geometry>
		<Box name="xneg" xMin="-0.01, -0.01, -0.01" xMax=" 0.01,  10.01, 10.01" />
		<Box name="xpos" xMin=" 9.99, -0.01, -0.01" xMax="10.01,  10.01, 10.01" />
		<Box name="yneg" xMin="-0.01, -0.01, -0.01" xMax="10.01,  0.01, 10.01" />
		<Box name="ypos" xMin="-0.01,  9.99, -0.01" xMax="10.01, 10.01, 10.01" />
		<Box name="zneg" xMin="-0.01, -0.01, -0.01" xMax="10.01,  10.01, 0.01" />
		<Box name="zpos" xMin="-0.01, -0.01,  9.99" xMax="10.01, 10.01, 10.01" />
		
		<BoundedPlane 
		name="FracturePlane" 
		normal="0, 1, 0"
		origin="0, 5.5, 5.5" 
		lengthVector="1, 0, 0" 
		widthVector="0, 0, 1"
		dimensions="{30, 30}" />
	</Geometry>


	<Events maxTime="10">
		<!--SoloEvent 
		name="output0" 
		target="/Outputs/siloOutput" /-->

		<SoloEvent 
		name="preFracture" 
		target="/Solvers/SurfaceGenerator" />

		<!--SoloEvent 
		name="output1" 
		target="/Outputs/siloOutput" /-->

		<PeriodicEvent 
		name="solverApplications" 
		forceDt="1e3"
		target="/Solvers/mechSolve" />

		<!--PeriodicEvent 
		name="outputs" 
		cycleFrequency="1"
		targetExactTimestep="1" 
		target="/Outputs/siloOutput" /-->
	</Events>

	<NumericalMethods>
	  <BasisFunctions>
		<LagrangeBasis3 name="linearBasis" degree="1" />
	  </BasisFunctions>

	  <QuadratureRules>
		<GaussQuadrature3 name="gaussian" degree="2" />
	  </QuadratureRules>

	  <FiniteElements>
		<FiniteElementSpace name="FE1" parentSpace="C3D8" basis="linearBasis" quadrature="gaussian" />
	  </FiniteElements>
    </NumericalMethods>

	<ElementRegions>
		<CellElementRegion 
		name="Region1" 
		cellBlocks="{cb1}"
		materialList="{rock}" />
		<EmbeddedSurfaceRegion 
		name="Fracture"
		materialList="{rock}"
		defaultAperture="1e-3"/>
	</ElementRegions>

	<Constitutive>
		<LinearElasticIsotropic 
		name="rock"
		defaultDensity="2700" 
		defaultBulkModulus="5.5556e9"
		defaultShearModulus="4.16667e9" />
		<!--Contact 
		name="fractureContact"
        penaltyStiffness="0.0e8">
        <TableFunction 
        name="aperTable" 
        coordinates = "{ -1.0e-3, 0.0}"
        values      = "{  1.0e-6, 1.0e-4}"/>
        </Contact-->
    </Constitutive>

	<FieldSpecifications>
	  <FieldSpecification name="xnegconstraint" 
	  objectPath="nodeManager" 
	  fieldName="TotalDisplacement" 
	  component="0" 
      scale="0.0" 
      setNames="{xneg, xpos}"/>

      <FieldSpecification name="yposconstraint"    
      objectPath="nodeManager" 
      fieldName="TotalDisplacement" 
      component="1" 
      scale="0.0" 
      setNames="{ypos}"/>
      
      <FieldSpecification name="ynegconstraint"    
      objectPath="nodeManager" 
      fieldName="TotalDisplacement" 
      component="1" 
      scale="-0.1" 
      setNames="{yneg}"/>
               
      <FieldSpecification name="zconstraint"    
      objectPath="nodeManager" 
      fieldName="TotalDisplacement" 
      component="2" 
      scale="0.0" 
      setNames="{zneg, zpos}"/>
	</FieldSpecifications>

	<Functions>
	</Functions>

	<Partition>
		<SpatialPartition xPar="1" yPar="1" zPar="1" />
	</Partition>

	<Outputs>
		<Silo name="siloOutput" 
		plotFileRoot="Sneddon"
		plotLevel="4" />
		<Restart name="sidreRestart" />
	</Outputs>

</Problem>
