<?xml version="1.0" ?>
<Problem>
  <Units length="m" mass="kg" time="s" temperature="K" mole="mol" />

  <Mesh 
  externalMeshFile="0"
  xcoords="-1.0 1.0"
  ycoords="0.0 3.0"
  zcoords="0.0 1.0"
  nx="2"
  ny="3"
  nz="1"
  elementType="C3D8"
  regionNames="Region"
  />


  <Nodesets>
    <Nodeset name="prefrac" 
             type="0"
             xmin="-0.01 -0.01 -0.01"
             xmax="0.01  2.01  1.01" />

    <Nodeset name="source" 
             type="0"
             xmin="-0.01 -0.01 -0.01"
             xmax="0.01  1.01  1.01" />

    <Nodeset name="core" 
             type="0"
             xmin="-0.01 -0.01 -0.01"
             xmax="0.01  10.01  1.01" />

  </Nodesets>


  <ElementRegions>
    <ElementRegion abaqusID="C3D8" name="Region" elementtype="poly">
        <LinearElasticMaterial ShearModulus="1.0e9 Pa" Density="2700 kg / m^3" BulkModulus="1.0e9 Pa"/>
    </ElementRegion>
  </ElementRegions>


  <InitialConditions>
  </InitialConditions>


    
  <Partition>
    <SpatialPartition xpar="1" ypar="1" zpar="1" />
  </Partition>


  <Fracture fractureFlag="1" 
	    failCriterion="2"
	    verbose="0" 
	    type="InitiallyRigidCohesiveZone"
	    rockToughness="1.0e6"
	    failstress="1.0e10 Pa"
	    failgap="0.1 m"
	    separableSet="core"
	    preFractureSetName="prefrac"
	    unloadFlag="0"
	    allowVacuumFrac="1"
	    />



  <Solvers>
    <Hydrofracture name="hfsolve"
                   nonDimensionalSystem="0"
                   useMLPreconditioner="1"
                   scalingOption="2"
                   timeIntegration="0"
                   ppSolverName="ppsolve"
                   lgSolverName="lagsolve"
                   hgStiff="0.0"
                   normalJointStiffness="0.0e14 Pa"
                   peanutButter="0.0"
                   tolNewton="1.0e-6"
                   maxIterNewton="20"
                   tol="1.0e-4"
                   maxResolves="2"
                   reuseK="0"
                   verbose="0"/>

    <LagrangeSmallStrainLinearElastic name="lagsolve" 
                                      timeIntegrationOption="0"
                                      dampingM="0.0"
                                      dampingK="0.0"
                                      newmarkGamma="0.9"
                                      />

    <ParallelPlateFlowSolverFVP name="ppsolve" 
                                tol="1e-9"
                                newtonTol="1.0e-8"
                                maxIterNewton="1"
                                useDirectSolver="0"
                                useMLPreconditioner="0"
                                verbose="2"
                                UpdateAperture="1"
                                MinimumAperture="0.0 mm"
                                MaximumAperture="100.0 mm"
                                ZeroApertureVolume="0.0 mm"
                                ZeroApertureOffset="0.0 mm"
                                boundPhysicalAperture="2"
                                apertureTable="aperTable"
                                permeabilityUpdateOption="0"
                                gamma="0.0e-9"
                                phi="1.0"
                                phiLimiter="0"
                                mu="0.001 Pa.s"
                                leakExtraMass="0"
                                incompressibleFlow="0"
                                steadyStateFlow="0"
                                BulkModulus="2e9 Pa"
                                cutoffPressure="-1.0e99 Pa"
                                negPressAperFix="0"
                                negPressSlopeReduction="1.0"/>
    </Solvers>

  <SolverApplications>
    <Application name="1" begintime="0.0" endtime="3.0 s" dt="1.0 s" >
      <Apply solver="hfsolve" toregions="Region"/>
    </Application>  
  </SolverApplications>






  <InitialConditions>
    <ConstantInitialCondition fieldname="Pressure" fieldtype="Scalar" object="Face" value="0.0 MPa" />
  </InitialConditions>


  <BoundaryConditions>


    <BoundaryCondition  object="Node" fieldname="Displacement" setnames="xneg" component="0" scale="0.0" fieldtype="Vector" /> 
    <BoundaryCondition  object="Node" fieldname="Displacement" setnames="xpos" component="0" scale="0.0" fieldtype="Vector" />
    <BoundaryCondition  object="Node" fieldname="Displacement" setnames="all" component="1" scale="0.0" fieldtype="Vector" />
    <BoundaryCondition  object="Node" fieldname="Displacement" setnames="all" component="1" scale="0.0" fieldtype="Vector" />
    <BoundaryCondition  object="Node" fieldname="Displacement" setnames="all" component="2" scale="0.0" fieldtype="Vector" /> 
    <BoundaryCondition  object="Node" fieldname="Displacement" setnames="all" component="2" scale="0.0" fieldtype="Vector" /> 

    
    <!--BoundaryCondition object="Face" fieldname="MassRate" setnames="source" scale="0.1" timetable="ptable" /-->
    <BoundaryCondition object="Face" fieldname="VolumeRate" setnames="source" scale="0.001" timetable="ptable" option="1"/>
    <!--BoundaryCondition object="Face" fieldname="Pressure" setnames="source" scale="1.0e6" timetable="ptable"/>
    <BoundaryCondition object="Face" fieldname="Pressure" setnames="sink" scale="0.0" timetable="ptable"/--> 

  </BoundaryConditions>

  <Tables>
    <Table1D name="ptable" 
               coord = "0.0, 2.0, 10.01, 1.0e9"
               value = "1.0, 1.0,  1.0, 1.0" />

    <Table1D name="aperTable" 
               coord = "-1.0 mm , 0.0 mm"
               value = "0.001 mm,  0.1 mm" />
  </Tables>


  <Output  writePlot="1"
	   plot_interval="1.0e-9"
	   writeRestart="0"
	   restart_interval="100.0"
	   plotfile_root="KGD_Randy" 
	   writeFEMFaces="1" 
	   writeFEMEdges="1" 
	   parallel_silo="1"
	   slave_directory="sub" />
</Problem>
