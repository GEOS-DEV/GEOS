<?xml version="1.0" ?>

<Problem>
  <Solvers
        gravityVector="{ 0.0, 0.0, 0.0 }">
    <SinglePhaseFVM
        name="SinglePhaseFlow"
        logLevel="1"
        discretization="singlePhaseTPFA"
        targetRegions="{ Domain, Faults }"
        initialDt="1e3">
      <NonlinearSolverParameters
        newtonTol="1.0e-3"
        newtonMaxIter="8"
        allowNonConverged="1"/>
      <LinearSolverParameters
        directParallel="0"/>
    </SinglePhaseFVM>

  </Solvers>

  <Mesh>
    <VTKMesh
      name="mesh1"
      file="./tmp/hi24l-coarse-fracture-duplicated-nodes-field-data.vtu"
      useGlobalIds="1"
      faceBlocks="{ fracture_info }"/>

  </Mesh>

  <Geometry>
   <Box
     name="source" 
     xMin="{ 0,        3273500, -3000 }"
     xMax="{ 10000000, 3278000, -1000 }"/>

   <Box
     name="production"
     xMin="{ 0,        3267200, -3000 }"
     xMax="{ 10000000, 3267500, -1000 }"/>        
  </Geometry>

  <Events
    maxTime="500000">
    <PeriodicEvent
      name="solverApplications"
      target="/Solvers/SinglePhaseFlow"/>

    <PeriodicEvent
      name="outputs"
      target="/Outputs/vtkOutput"/>
  </Events>

  <NumericalMethods>
    <FiniteVolume>
      <TwoPointFluxApproximation
        name="singlePhaseTPFA"/>
    </FiniteVolume>
  </NumericalMethods>

  <ElementRegions>
    <CellElementRegion
        name="Domain"
        cellBlocks="{ 0_tetrahedra }"
        materialList="{ water, rock }"/>

    <SurfaceElementRegion
        name="Faults"
        defaultAperture="1.0e-3"
        subRegionType="faceElement"
        faceBlock="fracture_info"
        materialList="{ water, fractureFilling }"/>
  </ElementRegions>

  <Constitutive>
    <CompressibleSinglePhaseFluid
        name="water"
        defaultDensity="1000"
        defaultViscosity="0.001"
        referencePressure="0.0"
        compressibility="1.0e-11"
        viscosibility="0.0"/>

    <CompressibleSolidParallelPlatesPermeability
        name="fractureFilling"
        solidModelName="nullSolid"
        porosityModelName="fracturePorosity"
        permeabilityModelName="fracturePerm"/>

    <CompressibleSolidConstantPermeability
        name="rock"
        solidModelName="nullSolid"
        porosityModelName="rockPorosity"
        permeabilityModelName="rockPerm"/>

    <NullModel
        name="nullSolid"/>

    <PressurePorosity
        name="rockPorosity"
        defaultReferencePorosity="0.2"
        referencePressure="0.0"
        compressibility="0.0"/>

    <ConstantPermeability
        name="rockPerm"
        permeabilityComponents="{ 1.0e-14, 1.0e-14, 1.0e-14 }"/>

    <PressurePorosity
        name="fracturePorosity"
        defaultReferencePorosity="1.00"
        referencePressure="0.0"
        compressibility="0.0"/>

    <ParallelPlatesPermeability
        name="fracturePerm"/>
  </Constitutive>

  <FieldSpecifications>
    <FieldSpecification
        name="Porosity"
        initialCondition="1"
        setNames="{ all }"
        objectPath="ElementRegions/Domain/0_tetrahedra"
        fieldName="rockPorosity_referencePorosity"
        scale="0.2"/>

    <FieldSpecification
        name="fracPorosity"
        initialCondition="1"
        setNames="{ all }"
        objectPath="ElementRegions/Faults"
        fieldName="fracturePorosity_porosity"
        scale="1.00"/>

    <FieldSpecification
        name="initialPressure"
        initialCondition="1"
        setNames="{ all }"
        objectPath="ElementRegions/"
        fieldName="pressure"
        scale="1.e6"/>

    <FieldSpecification
        name="source"
        objectPath="ElementRegions"
        fieldName="pressure"
        scale="2.0e6"
        setNames="{ source }"/>

    <FieldSpecification
        name="sink"
        objectPath="ElementRegions"
        fieldName="pressure"
        scale="5.0e5"
        setNames="{ production }"/>

  </FieldSpecifications>

  <Outputs>
    <VTK
        name="vtkOutput"
        plotFileRoot="hi24l_singlePhase"/>
  </Outputs>
</Problem>
