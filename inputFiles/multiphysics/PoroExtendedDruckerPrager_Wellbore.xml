<?xml version="1.0" ?>

<Problem>
<Included>
  <File name="./WellboreProblem_Base.xml"/>
</Included>

<!-- SPHINX_WELLBORE_MATERIAL -->
<Constitutive>
  <PorousExtendedDruckerPrager
    name="porousRock"
    solidModelName="rock"
    porosityModelName="rockPorosity"
    permeabilityModelName="rockPerm"
  />
  <ExtendedDruckerPrager 
    name="rock"
    defaultDensity="2700"
    defaultBulkModulus="1.111e10"
    defaultShearModulus="8.333e9"
    defaultCohesion="1.0e6"
    defaultInitialFrictionAngle="15.27"
    defaultResidualFrictionAngle="23.05"
    defaultDilationRatio="1.0"
    defaultHardening="0.01"
  />
  <CompressibleSinglePhaseFluid 
    name="water"
    defaultDensity="1000"
    defaultViscosity="0.001"
    referencePressure="0e6"
    referenceDensity="1000"
    compressibility="2.09028227021e-10"
    referenceViscosity="0.001"
    viscosibility="0.0"
  />
  <BiotPorosity
    name="rockPorosity"
    grainBulkModulus="1.0e27"
    defaultReferencePorosity="0.3"
  />    
  <ConstantPermeability
    name="rockPerm"
    permeabilityComponents="{1.0e-20, 1.0e-20, 1.0e-20}"
  /> 
</Constitutive>
<!-- SPHINX_WELLBORE_MATERIAL_END -->

<!-- SPHINX_WELLBORE_ELEMENTREGIONS -->
<ElementRegions>
  <CellElementRegion 
    name="Omega" 
    cellBlocks="{cb1}" 
    materialList="{ rock, water, porousRock, rockPerm, rockPorosity}"
  />
</ElementRegions>
<!-- SPHINX_WELLBORE_ELEMENTREGIONS_END -->

<!-- SPHINX_WELLBORE_POROMECHANICSSOLVER -->
<Solvers gravityVector="{0.0, 0.0, 0.0}">
<SinglePhasePoromechanics 
  name="PoromechanicsSolver" 
  solidSolverName="mechanicsSolver"
  fluidSolverName="SinglePhaseFlowSolver"
  porousMaterialNames="{porousRock}"
  logLevel="1"
  discretization="FE1"
  targetRegions="{Omega}">
  <LinearSolverParameters 
    solverType="direct"
    directParallel="0"
    logLevel="0"
  />
  <NonlinearSolverParameters
    newtonMaxIter = "40"
  />
</SinglePhasePoromechanics>
<!-- SPHINX_WELLBORE_POROMECHANICSSOLVER_END -->

<!-- SPHINX_WELLBORE_MECHANICALSOLVER -->
<SolidMechanics_LagrangianFEM 
  name="mechanicsSolver" 
  timeIntegrationOption="QuasiStatic"
  logLevel="1"
  discretization="FE1"
  targetRegions="{ Omega }"
  solidMaterialNames="{ rock }">
  <NonlinearSolverParameters
    newtonTol = "1.0e-5"
    newtonMaxIter = "15"
  />  
</SolidMechanics_LagrangianFEM>
<!-- SPHINX_WELLBORE_MECHANICALSOLVER_END -->

<!-- SPHINX_WELLBORE_SINGLEPHASEFVM -->
<SinglePhaseFVM 
  name="SinglePhaseFlowSolver"
  logLevel="1"
  discretization="singlePhaseTPFA"
  targetRegions="{Omega}"
  fluidNames="{ water }"
  solidNames="{ porousRock }"
  permeabilityNames="{rockPerm}"> 
  <NonlinearSolverParameters
    newtonTol = "1.0e-6"
    newtonMaxIter = "8"
  /> 
</SinglePhaseFVM>
</Solvers>
<!-- SPHINX_WELLBORE_SINGLEPHASEFVM_END -->

<!-- SPHINX_WELLBORE_NUMERICAL -->
<NumericalMethods>
  <FiniteElements>
    <FiniteElementSpace 
      name="FE1"
      order="1"/>
    </FiniteElements>
  <FiniteVolume>
    <TwoPointFluxApproximation 
      name="singlePhaseTPFA"
      fieldName="pressure"
      coefficientName="permeability"
      coefficientModelNames="{rockPerm}"
    />
  </FiniteVolume>
</NumericalMethods>
<!-- SPHINX_WELLBORE_NUMERICAL_END -->

<!-- SPHINX_WELLBORE_BC -->
<FieldSpecifications>
  <FieldSpecification 
    name="initialPressure"
    initialCondition="1"
    setNames="{all}"
    objectPath="ElementRegions/Omega/cb1"
    fieldName="pressure"
    scale="0e6"
  />

  <FieldSpecification 
    name="InnerFluidLoad"
    setNames="{ rneg }"
    objectPath="faceManager"
    fieldName="pressure"
    scale="10e6"
    functionName="timeFunction"   
  />
</FieldSpecifications>
<!-- SPHINX_WELLBORE_BC_END -->


<!-- SPHINX_WELLBORE_EXECUTION -->
<Events maxTime="80">

<PeriodicEvent 
  name="outputs"
  timeFrequency="80"
  targetExactTimestep="1"
  target="/Outputs/siloOutput"
/>

<PeriodicEvent 
  name="solverApplication0"
  forceDt="80"
  target="/Solvers/PoromechanicsSolver"
/>
</Events>
<!-- SPHINX_WELLBORE_EXECUTION_END -->

</Problem>
