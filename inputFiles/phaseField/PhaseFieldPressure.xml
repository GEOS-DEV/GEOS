<?xml version="1.0" ?>

<Problem>
  <Solvers
    gravityVector="{ 0.0, 0.0, 0.0 }">
    <PhaseFieldFracture
      name="PhaseFieldSolve"
      solidSolverName="SolidMechSolve"
      damageSolverName="DamageSolve"
      couplingTypeOption="FixedStress"
      logLevel="1"
      subcycling="0"
      discretization="FE1"
      targetRegions="{ Region1 }"
      pressureEffects="1">
      <NonlinearSolverParameters
        newtonMaxIter="1"/>
      <LinearSolverParameters
        directParallel="0"/>
    </PhaseFieldFracture>

    <SolidMechanicsLagrangianSSLE
      name="SolidMechSolve"
      timeIntegrationOption="QuasiStatic"
      logLevel="1"
      discretization="FE1"
      targetRegions="{ Region1 }"
      >
      <NonlinearSolverParameters
        newtonMaxIter="2"
        newtonTol="1.0e-6"/>
      <LinearSolverParameters
        directParallel="0"/>
    </SolidMechanicsLagrangianSSLE>

    <PhaseFieldDamageFEM
      name="DamageSolve"
      discretization="FE1"
      timeIntegrationOption="SteadyState"
      localDissipation="Linear"
      logLevel="1"
      targetRegions="{ Region1 }">
      <NonlinearSolverParameters
        newtonMaxIter="2"
        newtonTol="1.0e-12"/>
      <LinearSolverParameters
        directParallel="0"/>
    </PhaseFieldDamageFEM>
  </Solvers>

  <Mesh>
    <InternalMesh
      name="mesh1"
      elementTypes="{ C3D8 }"
      xCoords="{ -1, 1 }"
      yCoords="{ -1, 1 }"
      zCoords="{ -0.5, 0.5 }"
      nx="{ 2 }"
      ny="{ 2 }"
      nz="{ 1 }"
      cellBlockNames="{ cb1 }"/>
  </Mesh>

  <Events
    maxTime="2.0">
    <!-- <SoloEvent name="siloOutput0"
               target="/Outputs/SiloOutput"/> -->
    <!-- This event is applied every cycle, and overrides the
    solver time-step request -->
    <PeriodicEvent
      name="solverApplications"
      forceDt="1.0"
      target="/Solvers/PhaseFieldSolve"/>

    <!-- This event is applied every 1.0s.  The targetExactTimestep
    flag allows this event to request a dt modification to match an
    integer multiple of the timeFrequency. -->
    <PeriodicEvent
      name="vtkOutput"
      timeFrequency="1.0"
      target="/Outputs/DamageAndPressure_VTKOutput"/>

    <PeriodicEvent
      name="siloOutputs"
      timeFrequency="1.0"
      target="/Outputs/DamageAndPressure_SiloOutput"/>

    <PeriodicEvent
      name="restarts"
      timeFrequency="1.0"
      targetExactTimestep="0"
      target="/Outputs/restartOutput"/>
  </Events>

  <NumericalMethods>
    <FiniteElements>
      <FiniteElementSpace
        name="FE1"
        order="1"/>
    </FiniteElements>
  </NumericalMethods>

  <ElementRegions>
    <CellElementRegion
      name="Region1"
      cellBlocks="{ cb1 }"
      materialList="{ shale }"/>
  </ElementRegions>

  <Constitutive>
    <DamageElasticIsotropic
      name="shale"
      defaultDensity="2700"
      defaultBulkModulus="3.6"
      defaultShearModulus="3.6"
      lengthScale="0.2"
      criticalFractureEnergy="2.7"
      criticalStrainEnergy="0"/>
  </Constitutive>

  <FieldSpecifications>
    <FieldSpecification
      name="fixLeftX"
      fieldName="TotalDisplacement"
      component="0"
      objectPath="nodeManager"
      scale="0"
      setNames="{ xneg }"/>

    <FieldSpecification
      name="fixLeftY"
      fieldName="TotalDisplacement"
      component="1"
      objectPath="nodeManager"
      scale="0"
      setNames="{ xneg }"/>  

    <FieldSpecification
      name="fixBottomX"
      fieldName="TotalDisplacement"
      component="0"
      objectPath="nodeManager"
      setNames="{ yneg }"/>

    <FieldSpecification
      name="fixBottomY"
      fieldName="TotalDisplacement"
      component="1"
      objectPath="nodeManager"
      setNames="{ yneg }"/>      

    <FieldSpecification
      name="pullCornerX"
      fieldName="TotalDisplacement"
      component="0"
      objectPath="nodeManager"
      scale="1"
      setNames="{ corner }"/>

    <FieldSpecification
      name="pullCornerY"
      fieldName="TotalDisplacement"
      component="1"
      objectPath="nodeManager"
      scale="1"
      setNames="{ corner }"/>  

    <FieldSpecification
      name="zfix"
      fieldName="TotalDisplacement"
      component="2"
      objectPath="nodeManager"
      setNames="{ all }"/>

    <FieldSpecification
      name="pointSource"
      fieldName="Damage"
      objectPath="nodeManager"
      scale="1.0"
      setNames="{ centerPoint }"/>
  </FieldSpecifications>

  <Functions>
    <!-- These are example mathpresso functions.  In order to use them, you need to specify the order that the
    symbolic math function should expect the variables to be given, and an expression that it will compile.
    A list of available functions is given here: https://github.com/kobalicek/mathpresso -->
    <TableFunction
      name="f_b"
      inputVarNames="{ time }"
      coordinates="{ 0, 130 }"
      values="{ -0.5, 129.5 }"/>
  </Functions>

  <Outputs>
    <Silo
      name="DamageAndPressure_SiloOutput"/>

    <VTK
      name="DamageAndPressure_VTKOutput"
      plotFileRoot="plot"/>

    <Restart
      name="restartOutput"/>
  </Outputs>

  <Geometry>
    <Box
      name="centerPoint"
      xMin="{ -0.001, -0.001, -1.001 }"
      xMax="{ +0.001, +0.001, +1.001 }"/>

    <Box
      name="corner"
      xMin="{ +0.999, +0.999, -1.001 }"
      xMax="{ +1.001, +1.001, +1.001 }"/>  
  </Geometry>
</Problem>
