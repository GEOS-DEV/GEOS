<?xml version="1.0" ?>

<Problem>
  <Solvers>
    <AcousticSEM
      name="acousticSolver"
      cflFactor="0.25"
      discretization="FE1"
      targetRegions="{ Fluid }"
      sourceCoordinates="{ { 1500, 800, 2900 } }"
      timeSourceFrequency="10"
      receiverCoordinates="{ { 3752.29351, 800, 2933.3333 } }"
      rickerOrder="3"
      outputSeismoTrace="1"
      dtSeismoTrace="1e-2"/>
    <ElasticSEM
      name="elasticSolver"
      cflFactor="0.25"
      discretization="FE1"
      targetRegions="{ Solid }"
      sourceCoordinates="{ }"
      timeSourceFrequency="0"
      receiverCoordinates="{ }"
      outputSeismoTrace="1"
      dtSeismoTrace="1e-2"/>
    <!-- NOTE: the coupled solver must be declared at the end (for interface computations) -->
    <!-- NOTE: discretization is also needed for the correct mesh to be passed through from the coupled solver to the elastic / acoustic solvers -->
    <AcousticElasticSEM
      name="acousticelasticSolver"
      cflFactor="0.25"
      discretization="FE1"
      targetRegions="{ Solid, Fluid }"
      acousticSolverName="acousticSolver"
      elasticSolverName="elasticSolver"/>
  </Solvers>

  <NumericalMethods>
    <FiniteElements>
      <FiniteElementSpace
        name="FE1"
        order="1"
        formulation="SEM"/>
    </FiniteElements>
  </NumericalMethods>

  <ElementRegions>
    <CellElementRegion
      name="Fluid"
      cellBlocks="{ 0_hexahedra }"
      materialList="{ nullModel }"/>
    <CellElementRegion
      name="Solid"
      cellBlocks="{ 1_hexahedra }"
      materialList="{ nullModel }"/>
  </ElementRegions>

  <Constitutive>
    <NullModel name="nullModel"/>
  </Constitutive>

  <!-- file="acouselas3D_flu_komatitsch.vtu" -->
  <!-- file="../../../Debug/acouselas3D_flu_komatitsch.vtu" -->
  <Mesh>
    <VTKMesh
      name="Bilayer"
      fieldsToImport="{ mediumVelocity,mediumVelocityVp,mediumVelocityVs,mediumDensity }"    
      fieldNamesInGEOSX="{ mediumVelocity,mediumVelocityVp,mediumVelocityVs,mediumDensity }"
      file="../../../Debug/acouselas3D_flu_komatitsch.vtu"
      useGlobalIds="0"
      logLevel="1"/>
  </Mesh> 

  <!-- read from the Mesh instead -->
  <FieldSpecifications>
  </FieldSpecifications>

  <Outputs>
    <VTK
      name="vtkOutput"
      writeFEMFaces="1"/>
  </Outputs>

  <Events maxTime="3">
    <PeriodicEvent
      name="solidfluidSolverApplications"
      forceDt="4.2e-4"
      target="/Solvers/acousticelasticSolver"/>
    <!-- control the timestepping here with forceDt -->
    <SoloEvent
      name="solidSolverApplications"
      forceDt="4.2e-4"
      endTime="0"
      target="/Solvers/elasticSolver"/>
    <SoloEvent
      name="fluidSolverApplications"
      forceDt="4.2e-4"
      endTime="0"
      target="/Solvers/acousticSolver"/>
    <!-- output -->
    <PeriodicEvent
      name="outputs"
      timeFrequency="2e-2"
      targetExactTimestep="0"
      target="/Outputs/vtkOutput">
    </PeriodicEvent>
  </Events>

</Problem>
