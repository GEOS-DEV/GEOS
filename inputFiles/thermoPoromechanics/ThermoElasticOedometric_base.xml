<?xml version="1.0" ?>

<Problem>
  <Solvers>
    <SinglePhasePoromechanics
      name="thermoElasticSolver"
      solidSolverName="solidMechSolver"
      flowSolverName="flowSolver"
      logLevel="1"
      isThermal="1"
      targetRegions="{ rock }">
      <NonlinearSolverParameters
        couplingType="FullyImplicit"
        maxAllowedResidualNorm="1e19"
        newtonMaxIter="100"/>
      <LinearSolverParameters
        directParallel="0"/>
    </SinglePhasePoromechanics>

    <SolidMechanicsLagrangianSSLE
      name="solidMechSolver"
      timeIntegrationOption="QuasiStatic"
      logLevel="1"
      discretization="FE1"
      targetRegions="{ rock }">
    </SolidMechanicsLagrangianSSLE>
   
    <SinglePhaseFVM
      name="flowSolver"
      logLevel="1"
      discretization="tpfaFlow"
      temperature="0"
      isThermal="1"
      targetRegions="{ rock }">
      <NonlinearSolverParameters
	normType="L2"/>
    </SinglePhaseFVM>
  </Solvers>

  <NumericalMethods>
    <FiniteElements>
      <FiniteElementSpace
        name="FE1"
        order="1"/>
    </FiniteElements>

    <FiniteVolume>
      <TwoPointFluxApproximation
        name="tpfaFlow"/>
    </FiniteVolume>
  </NumericalMethods>

  <ElementRegions>
    
    <CellElementRegion
      name="rock"
      cellBlocks="{ rock }"
      materialList="{ fluid, rock, rockThermalCond }"/>
  </ElementRegions>

  <Constitutive>
    <PorousElasticIsotropic
      name="rock"
      solidModelName="rockSolid"
      porosityModelName="rockPorosity"
      permeabilityModelName="rockPerm"
      solidInternalEnergyModelName="rockInternalEnergy"/>

    <!-- SPHINX_PoroElasticProperties -->
     <BiotPorosity
      name="rockPorosity"
      defaultReferencePorosity="1e-6"
      defaultGrainBulkModulus="5.535714286e9"/>
    <!-- SPHINX_PoroElasticPropertiesEnd -->

    <!-- SPHINX_HeatCapacityProperties -->
    <SolidInternalEnergy
      name="rockInternalEnergy"
      referenceVolumetricHeatCapacity="4.56e6"
      referenceTemperature="0"
      referenceInternalEnergy="0"/>
    <!-- SPHINX_HeatCapacityPropertiesEnd -->

    <!-- SPHINX_PermeabilityProperties -->
    <ConstantPermeability
      name="rockPerm"
      permeabilityComponents="{ 1.0e-100, 1.0e-100, 1.0e-100 }"/>
    <!-- SPHINX_PermeabilityPropertiesEnd -->

    <!-- SPHINX_ThermalProperties -->
    <SinglePhaseConstantThermalConductivity
      name="rockThermalCond"
      thermalConductivityComponents="{ 1.66, 1.66, 1.66 }"/>
    <!-- SPHINX_ThermalPropertiesEnd -->

    <!-- SPHINX_FluidProperties -->
    <ThermalCompressibleSinglePhaseFluid
      name="fluid"
      defaultDensity="1000"
      defaultViscosity="1e-3"
      referencePressure="0.0"
      referenceTemperature="20.0"
      compressibility="5e-10"
      thermalExpansionCoeff="1e-10"
      viscosibility="0.0"
      specificHeatCapacity="1"
      referenceInternalEnergy="1"/>
    <!-- SPHINX_FluidPropertiesEnd -->

	<!-- SPHINX_ThermoElasticProperties -->
    <ElasticIsotropic
      name="rockSolid"
      defaultDensity="2700"
      defaultBulkModulus="9.12345679e9"
      defaultShearModulus="6.00813e9"
      defaultDrainedLinearTEC="0.2e-5"
      dDrainedLinearTEC_dT="0.0082e-5"/>
    <!-- SPHINX_ThermoElasticPropertiesEnd -->
    
  </Constitutive>

  <FieldSpecifications>

    <!-- SPHINX_FixedFarFieldBC -->
    <FieldSpecification
      name="constraint_x"
      objectPath="nodeManager"
      fieldName="totalDisplacement"
      component="0"
      scale="0.0"
      setNames="{ xneg, xpos }"/>

    <FieldSpecification
      name="constraint_y"
      objectPath="nodeManager"
      fieldName="totalDisplacement"
      component="1"
      scale="0.0"
      setNames="{ yneg, ypos }"/>
    <!-- SPHINX_FixedFarFieldBCEnd -->

    <!-- SPHINX_PlaneStrainAxisymmetryBC -->
    <FieldSpecification
      name="zConstraint"
      objectPath="nodeManager"
      fieldName="totalDisplacement"
      component="2"
      scale="0.0"
      setNames="{ zneg }"/>

    <!-- SPHINX_PlaneStrainAxisymmetryBCEnd -->

    

    <FieldSpecification
      name="initialSigma_x_rock"
      initialCondition="1"
      setNames="{ all }"
      objectPath="ElementRegions/rock/rock"
      fieldName="rockSolid_stress"
      component="0"
      scale="0"/>
    <FieldSpecification
      name="initialSigma_y_rock"
      initialCondition="1"
      setNames="{ all }"
      objectPath="ElementRegions/rock/rock"
      fieldName="rockSolid_stress"
      component="1"
      scale="0"/>
    <FieldSpecification
      name="initialSigma_z_rock"
      initialCondition="1"
      setNames="{ all }"
      objectPath="ElementRegions/rock/rock"
      fieldName="rockSolid_stress"
      component="2"
      scale="0"/>

    <!-- SPHINX_ZeroPorePressureBC -->
    <FieldSpecification
      name="zeroPressure"
      setNames="{ all }"
      objectPath="ElementRegions"
      fieldName="pressure"
      scale="0e6"/>

    
    <!-- SPHINX_ZeroPorePressureBCEnd -->

    <!-- SPHINX_TemperatureBC -->
    <FieldSpecification
      name="initialTemperature"
      initialCondition="1"
      setNames="{ all }"
      objectPath="ElementRegions"
      fieldName="temperature"
      scale="0"/>

    <FieldSpecification
      name="appliedTemperature"
      setNames="{ all }"     
      objectPath="ElementRegions"
      fieldName="temperature"
      scale="1"
      functionName="temperatureTable"
      />
    <!-- SPHINX_TemperatureBCEnd functionName="temperatureTable"-->

    <!-- SPHINX_ZeroInnerTractionBC -->
    <!--Traction
      name="verticalLoading"
      objectPath="faceManager"
      tractionType="normal"
      scale="0.0e6"
      setNames="{ zpos }"/-->
    <!-- SPHINX_ZeroInnerTractionBCEnd -->

  </FieldSpecifications>
  
  <!-- SPHINX_TableFunction -->
  <Functions>
    <TableFunction
      name="temperatureTable"
      inputVarNames="{ time }"
      coordinates="{ 0.0, 1.0e5 }"
      values="{ 0, 90 }"/>
  </Functions>
  <!-- SPHINX_TableFunctionEnd -->

  <Tasks>

    <!-- SPHINX_TemperatureCollection -->
    
    <PackCollection
      name="temperatureCollection_rock"
      objectPath="ElementRegions/rock/rock"
      fieldName="temperature"/>
    <!-- SPHINX_TemperatureCollectionEnd -->

    <!-- SPHINX_SolidStressCollection -->
    
    <PackCollection
      name="stressCollection_rock"
      objectPath="ElementRegions/rock/rock"
      fieldName="rockSolid_stress"/>
    <!-- SPHINX_SolidStressCollectionEnd -->

    

  </Tasks>

  <Outputs>
    <!-- SPHINX_TemperatureTimeHistory -->
    
    <TimeHistory
      name="temperatureHistoryOutput_rock"
      sources="{ /Tasks/temperatureCollection_rock }"
      filename="temperatureHistory_rock"/>
    <!-- SPHINX_TemperatureTimeHistoryEnd -->

    <!-- SPHINX_SolidStressTimeHistory -->
    
    <TimeHistory
      name="stressHistoryOutput_rock"
      sources="{ /Tasks/stressCollection_rock }"
      filename="stressHistory_rock"/>
    <!-- SPHINX_SolidStressTimeHistoryEnd -->


    <VTK
      name="vtkOutput"/>

   
  </Outputs>
</Problem>
