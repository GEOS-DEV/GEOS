<!--# {{short}} # -->
<!--# {{long}} # -->
<Problem>
  <Solvers gravityVector="0.0, 0.0, -9.81">

    <Reservoir name="reservoirSystem"
               flowSolverName="singlePhaseFlow"
               wellSolverName="singlePhaseWell"
	       logLevel="1"
               targetRegions="{domain,
			       wellRegion1,
			       wellRegion2,
			       wellRegion3,
			       wellRegion4,
			       wellRegion5}">
      <SystemSolverParameters maxIterNewton="40"
  	      	              logLevel="0"
                              useDirectSolver="1"
                              maxSubSteps="10"
                              maxTimeStepCuts="10"
                              newtonTol="1e-6"/>
    </Reservoir>
 
    <SinglePhaseFlow name="singlePhaseFlow"
      	      	     logLevel="0"
                     gravityFlag="1"
                     discretization="singlePhaseTPFA"
                     fluidName="water"
                     solidName="rock"
                     targetRegions="{domain}">
    </SinglePhaseFlow>

    <SinglePhaseWell name="singlePhaseWell"
      	             logLevel="1"
                     gravityFlag="1"
                     wellFluidName="water"
                     targetRegions="{wellRegion1,
				     wellRegion2,
				     wellRegion3,
				     wellRegion4,
				     wellRegion5}">
        <WellControls name="wellControls1"
                      type="producer"
                      control="BHP"
                      targetBHP="1e5"
                      targetRate="1e9"/>
        <WellControls name="wellControls2"
                      type="producer"
                      control="BHP"
                      targetBHP="1e5"
                      targetRate="1e9"/>
        <WellControls name="wellControls3"
                      type="injector"
                      control="liquidRate" 
                      targetBHP="1e8"
                      targetRate="200"/>
        <WellControls name="wellControls4"
                      type="injector"
                      control="liquidRate" 
                      targetBHP="1e8"
                      targetRate="200"/>
        <WellControls name="wellControls5"
                      type="injector"
                      control="liquidRate" 
                      targetBHP="1e8"
                      targetRate="200"/>
    </SinglePhaseWell>

  </Solvers>

  <Mesh>
    <PAMELAMeshGenerator name="domain"
			 file="/g/g90/hamon1/geosx/GEOSX/examples/fluidFlow/data/SPE9.GRDECL"
			 scale="0.3048"/>

    <InternalWell name="wellProducer1"
                  wellRegionName="wellRegion1"
                  wellControlsName="wellControls1"
                  meshName="domain"
                  polylineNodeCoords="{ {1788, 1900, 3160}, 
                                        {1788, 1900, 3140} }"
                  polylineSegmentConn="{ {0, 1} }"
                  radius="0.1"
                  numElementsPerSegment="2">
     <Perforation name="producer1_perf1"
                  distanceFromHead="19.9"
                  wellPeacemanIndex="1e-10"/> 
    </InternalWell> 

    <InternalWell name="wellProducer2"
                  wellRegionName="wellRegion2"
                  wellControlsName="wellControls2"
                  meshName="domain"
                  polylineNodeCoords="{ {1788, 355, 3160}, 
                                        {1788, 355, 3140} }"
                  polylineSegmentConn="{ {0, 1} }"
                  radius="0.1"
                  numElementsPerSegment="2">
     <Perforation name="producer2_perf1"
                  distanceFromHead="19.9"
                  wellPeacemanIndex="1e-10"/> 
    </InternalWell> 
    
    <InternalWell name="wellInjector1"
                  wellRegionName="wellRegion3"
                  wellControlsName="wellControls3"
                  meshName="domain"
                  polylineNodeCoords="{ {355, 1900, 2905}, 
                                        {355, 1900, 2955} }"
                  polylineSegmentConn="{ {0, 1} }"
                  radius="0.1"
                  numElementsPerSegment="4">
     <Perforation name="injector1_perf1"
                  distanceFromHead="49.35"
                  wellPeacemanIndex="1e-10"/> 
    </InternalWell>

    <InternalWell name="wellInjector2"
                  wellRegionName="wellRegion4"
                  wellControlsName="wellControls4"
                  meshName="domain"
                  polylineNodeCoords="{ {355, 355, 2905}, 
                                        {355, 355, 2955} }"
                  polylineSegmentConn="{ {0, 1} }"
                  radius="0.1"
                  numElementsPerSegment="4">
     <Perforation name="injector2_perf1"
                  distanceFromHead="49.35"
                  wellPeacemanIndex="1e-10"/> 
    </InternalWell>

    <InternalWell name="wellInjector3"
                  wellRegionName="wellRegion5"
                  wellControlsName="wellControls5"
                  meshName="domain"
                  polylineNodeCoords="{ {355, 1050, 2905},
                                        {355, 1050, 2955} }"
                  polylineSegmentConn="{ {0, 1} }"
                  radius="0.1"
                  numElementsPerSegment="4">
     <Perforation name="injector3_perf1"
                  distanceFromHead="49.35"
                  wellPeacemanIndex="1e-10"/> 
    </InternalWell>

  </Mesh>
  
  <Geometry>
    <Box name="all" xMin="-1e9, -1e9, -1e9" xMax="1e9, 1e9, 1e9"/>
  </Geometry>

  <ElementRegions>
    <CellElementRegion name="domain"
                       cellBlocks="{0_HEX}"
                       materialList="{water, rock}"/>
    <WellElementRegion name="wellRegion1"
                       materialList="{water}"/> 
    <WellElementRegion name="wellRegion2"
                       materialList="{water}"/>
    <WellElementRegion name="wellRegion3"
                       materialList="{water}"/> 
    <WellElementRegion name="wellRegion4"
                       materialList="{water}"/>
    <WellElementRegion name="wellRegion5"
                       materialList="{water}"/>
  </ElementRegions>

  <Events maxTime="1e5">
    <!-- This event is applied every cycle, and overrides the
    solver time-step request -->
    <PeriodicEvent name="solverApplications"
                   forceDt="1e4"
                   target="/Solvers/reservoirSystem" />
    <!-- This event is applied every 1.0s.  The targetExactTimestep
    flag allows this event to request a dt modification to match an
    integer multiple of the timeFrequency. -->
    <PeriodicEvent name="outputs"
                   timeFrequency="1e4"
                   targetExactTimestep="1"
                   target="/Outputs/siloOutput" />
  </Events>

  <NumericalMethods>
    <FiniteVolume>
      <TwoPointFluxApproximation name="singlePhaseTPFA"
                                 fieldName="pressure"
                                 boundaryFieldName="facePressure"
                                 targetRegions="{domain}"
                                 coefficientName="permeability"/>
    </FiniteVolume>
  </NumericalMethods>
   <Constitutive>
    <CompressibleSinglePhaseFluid name="water"
                                  defaultDensity="1000"
                                  defaultViscosity="0.001"
                                  referencePressure="0.0"
                                  referenceDensity="1000"
                                  compressibility="1e-10"
                                  referenceViscosity="0.001"
                                  viscosibility="0.0"/>
    <PoreVolumeCompressibleSolid name="rock"
                                 referencePressure="0.0"
                                 compressibility="1e-9"/>
  </Constitutive> 

  <FieldSpecifications>
    <FieldSpecification name="permx"
               component="0"
               initialCondition="1"
               setNames="{all}"
               objectPath="ElementRegions/domain"
               fieldName="permeability"
               scale="100.0e-15"/>
    <FieldSpecification name="permy"
               component="1"
               initialCondition="1"
               setNames="{all}"
               objectPath="ElementRegions/domain"
               fieldName="permeability"
               scale="60.0e-15"/>
    <FieldSpecification name="permz"
               component="2"
               initialCondition="1"
               setNames="{all}"
               objectPath="ElementRegions/domain"
               fieldName="permeability"
               scale="25.0e-15"/>
    <FieldSpecification name="referencePorosity"
               initialCondition="1"
               setNames="{all}"
               objectPath="ElementRegions/domain"
               fieldName="referencePorosity"
               scale="0.05"/>
    <FieldSpecification name="initialPressure"
               initialCondition="1"
               setNames="{all}"
               objectPath="ElementRegions/domain"
               fieldName="pressure"
               scale="1e6"/>

  </FieldSpecifications>
  <Functions>
  </Functions>
  <Outputs>
    <Silo name="siloOutput"/>
  </Outputs>
  </Problem>
